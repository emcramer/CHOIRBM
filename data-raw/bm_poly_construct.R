# helper function for splitting coordinates
split_coords <- function(coords, id) {
  data.frame(
    id = id
    , x = coords[seq.int(1, length(coords), 2)]
    , y = coords[seq.int(2, length(coords), 2)]
  )
}

# constructing polygons for the bodymap
front_polys <- list(
    "101" = c(140,43,140,19,140,18,132,18,126,20,121,22,118,26,115,30,114,34,115,39,126,41,130,42,140,43)
  , "102" = c(165,40,165,31,162,25,158,21,153,19,147,18,141,18,141,42,152,42,159,41,165,40)
  , "103" = c(114,40,130,43,140,43,140,84,123,80,118,75,117,66,109,55,109,49,110,47,113,47,116,50,115,46,114,40)
  , "104" = c(141,84,150,83,156,81,160,78,163,72,163,66,170,56,172,49,170,47,167,47,164,49,165,46,165,41,149,42,141,43,141,84)
  , "105" = c(140,108,140,85,125,81,122,81,122,96,119,99,129,105,140,108)
  , "106" = c(158,81,158,98,160,99,150,106,144,108,141,108,141,85,148,84,154,82,158,81)
  , "107" = c(119,99,94,111,81,114,73,118,67,125,65,133,61,148,62,163,78,157,93,146,101,138,113,125,122,109,125,103,119,99)
  , "108" = c(140,195,140,109,131,106,125,103,116,121,109,130,101,139,93,147,85,153,90,162,91,170,91,180,90,187,92,197,93,210,94,216,111,216,117,215,121,213,125,206,130,200,134,196,140,195)
  , "109" = c(155,103,162,115,171,128,177,135,188,146,197,153,193,160,190,171,190,182,191,190,188,208,187,216,171,216,164,214,160,212,157,206,152,200,147,197,145,195,141,195,141,109,146,107,151,105,155,103)
  , "110" = c(219,162,205,157,199,153,190,147,181,138,173,130,167,121,162,113,156,103,160,99,169,102,180,107,187,111,195,113,203,115,210,121,214,127,217,134,220,145,219,162)
  , "111" = c(85,207,89,187,91,180,91,170,89,162,85,153,77,158,67,162,62,163,62,169,63,178,62,185,62,204,69,203,69,202,77,203,80,204,85,207)
  , "112" = c(220,205,211,203,205,203,199,206,197,208,193,195,191,183,189,172,192,161,197,153,204,156,212,160,219,163,218,173,219,180,220,194,220,205)
  , "113" = c(81,222,81,216,84,208,77,203,69,203,63,204,61,205,60,212,55,219,62,224,77,224,81,222)
  , "114" = c(200,222,200,215,197,208,203,203,212,203,215,204,220,205,220,212,225,217,226,221,220,224,206,224,200,222)
  , "115" = c(46,267,49,251,49,243,51,230,55,220,61,224,70,225,78,225,81,223,81,235,79,244,76,252,74,257,69,267,64,274,61,270,56,267,52,267,46,267)
  , "116" = c(95,217,94,232,92,240,92,245,92,256,97,258,103,261,107,264,111,271,111,276,112,287,110,292,116,291,119,288,123,285,129,279,129,279,137,273,140,273,140,247,140,197,137,196,130,200,125,207,120,214,112,216,109,216,95,217)
  , "117" = c(171,290,165,290,158,286,149,277,145,274,141,273,141,196,146,196,151,200,155,205,159,212,164,215,169,216,187,217,187,231,189,238,189,251,189,256,184,258,179,260,176,263,173,266,171,271,170,276,171,290)
  , "118" = c(200,223,201,239,203,246,209,261,217,274,221,270,227,267,233,268,235,267,233,254,232,243,230,231,228,226,226,221,222,223,218,224,207,225,203,224,200,223)
  , "119" = c(56,289,64,274,60,270,54,268,46,268,41,280,38,282,38,286,39,288,42,291,45,292,52,293,56,289)
  , "120" = c(86,312,87,291,90,272,91,257,96,258,102,261,106,265,110,271,112,277,112,289,109,295,106,300,103,304,99,307,93,310,86,312)
  , "121" = c(140,274,136,274,131,278,126,283,122,288,117,290,112,291,110,293,115,295,117,297,126,305,131,309,138,310,141,310,140,274)
  , "122" = c(170,291,163,290,156,283,150,278,145,274,141,273,141,310,148,310,152,308,160,301,165,296,169,294,172,294,170,291)
  , "123" = c(191,269,189,257,184,258,177,262,174,267,171,273,170,279,171,291,174,295,177,301,182,305,187,310,195,313,195,293,193,275,191,269)
  , "124" = c(235,268,238,276,242,282,243,287,237,292,229,292,226,291,217,275,220,271,226,268,235,268)
  , "125" = c(38,282,38,288,44,292,52,293,56,290,56,301,54,309,52,314,50,314,47,327,44,335,43,337,41,336,43,328,45,319,43,320,41,325,40,330,36,338,34,339,32,337,29,338,29,333,33,318,32,315,31,315,30,321,29,328,27,333,25,335,26,324,28,310,28,297,27,297,20,302,13,303,13,301,20,295,26,288,31,285,36,282,38,282)
  , "126" = c(86,313,87,329,89,344,94,361,98,382,102,393,102,400,108,397,122,396,129,400,135,402,136,374,136,337,139,320,139,311,132,309,127,306,119,299,114,294,111,293,108,297,105,301,103,303,100,306,96,308,94,309,90,311,86,313)
  , "127" = c(142,311,143,322,144,334,144,344,144,358,145,371,146,382,145,394,147,402,152,399,159,397,163,396,173,396,176,398,179,399,180,392,182,380,187,361,190,349,194,333,194,327,195,313,188,310,181,306,175,300,173,296,172,293,168,295,164,297,161,300,157,304,154,308,148,310,142,311)
  , "128" = c(243,282,249,284,255,289,260,294,268,301,267,304,262,304,255,298,253,296,256,328,257,336,255,336,251,323,249,315,248,316,250,327,252,335,252,339,250,338,249,337,248,337,248,340,246,340,239,323,236,318,238,325,239,333,240,337,235,331,233,323,232,317,230,314,227,310,226,300,225,290,228,292,237,292,240,290,243,287,243,282)
  , "129" = c(99,431,100,418,102,409,102,401,107,397,122,397,129,400,134,403,134,411,133,419,132,425,130,428,130,434,123,437,111,437,105,435,105,435,99,431)
  , "130" = c(146,403,147,412,149,422,152,429,152,434,162,437,172,436,178,434,183,431,181,417,179,407,179,400,171,397,165,395,160,396,154,399,150,400,146,403)
  , "131" = c(98,432,96,444,95,454,96,463,99,475,107,503,115,501,120,499,125,500,129,501,130,495,131,476,131,450,130,441,129,436,121,437,113,437,106,436,98,432)
  , "132" = c(151,435,151,453,150,465,150,481,151,491,151,501,156,500,164,499,170,502,174,504,178,491,183,474,185,463,185,449,184,436,183,431,179,435,171,438,159,437,151,435)
  , "133" = c(107,504,113,526,113,531,122,531,129,531,131,530,131,526,130,515,129,502,125,500,118,500,114,501,107,504)
  , "134" = c(149,530,150,525,152,516,151,501,156,501,157,499,165,499,167,501,170,502,174,504,168,527,168,532,162,532,155,532,149,530)
  , "135" = c(133,531,131,539,131,546,132,554,133,560,130,562,124,562,123,561,110,561,107,559,103,559,103,557,107,553,112,542,112,540,111,538,113,531,113,531,133,531)
  , "136" = c(149,530,149,539,151,544,151,551,148,558,150,562,156,563,159,561,172,562,174,559,178,559,178,556,172,549,169,543,169,540,170,537,168,532,153,531,149,530)
)

# get the coords for the front
male_front_poly_coords_l <- list()
for(i in 1:length(front_polys)){
  this_id <- names(front_polys)[i]
  tmp_df <- split_coords(front_polys[[i]], this_id)
  male_front_poly_coords_l[[i]] <- tmp_df
}
male_front_poly_coords_df <- do.call(rbind, male_front_poly_coords_l)

# backside of choir bm
back_polys <- list(
    "201" = c(120,34,120,27,123,21,131,15,140,13,146,13,146,38,138,38,130,37,124,36,121,36,120,34)
  , "202" = c(171,24,172,36,159,37,146,37,147,14,155,14,164,17,171,24)
  , "203" = c(121,46,120,39,120,35,128,38,136,39,146,38,146,82,132,82,129,81,128,76,125,73,123,69,122,61,119,58,116,53,115,49,115,45,117,42,120,43,121,46)
  , "204" = c(164,81,165,75,169,70,170,62,176,53,178,45,175,42,172,44,170,46,172,40,172,36,159,37,147,38,147,82,164,81)
  , "205" = c(146,82,147,105,141,104,131,100,125,95,128,92,128,81,133,83,146,82)
  , "206" = c(164,82,164,92,167,95,149,105,148,105,147,84,146,83,161,83,164,82)
  , "207" = c(124,96,131,99,129,107,126,116,122,125,115,136,105,148,99,154,91,159,87,161,78,161,70,159,67,158,66,147,67,138,70,128,74,120,78,115,89,109,98,108,124,96)
  , "208" = c(131,100,127,115,122,127,115,138,108,146,101,153,91,160,121,165,146,165,146,106,131,100)
  , "209" = c(161,99,147,106,146,165,175,165,201,160,198,158,187,149,179,139,172,127,167,116,163,106,161,99)
  , "210" = c(216,116,208,111,202,109,194,108,167,96,162,99,165,112,170,123,177,134,184,144,192,152,199,159,203,160,211,161,219,160,225,159,227,142,224,130,220,122,216,116)
  , "211" = c(90,204,94,191,95,184,90,162,85,160,77,161,71,160,67,159,68,169,67,176,66,187,66,204,73,200,83,200,90,204)
  , "212" = c(91,161,96,188,98,201,99,215,100,226,114,228,128,232,146,231,146,166,133,166,124,166,112,164,102,162,91,161)
  , "213" = c(201,161,197,184,195,196,194,210,194,226,172,230,148,231,147,166,160,165,173,165,190,162,201,161)
  , "214" = c(227,202,227,184,226,175,225,168,226,163,225,159,212,161,201,159,198,161,197,169,197,175,198,182,201,193,203,206,208,202,213,200,217,200,221,200,227,202)
  , "215" = c(61,218,66,222,80,222,86,220,87,214,90,204,83,201,72,201,66,204,66,209,61,218)
  , "216" = c(233,218,227,222,213,222,207,219,206,213,204,206,210,201,220,200,225,201,227,203,228,209,233,218)
  , "217" = c(69,271,80,250,84,242,86,233,87,221,81,223,70,222,63,221,61,218,58,224,57,233,56,241,54,252,52,260,51,265,55,265,61,266,65,268,69,271)
  , "218" = c(101,226,98,233,98,241,98,248,104,249,110,255,113,258,127,263,141,264,146,265,146,232,129,232,118,230,110,228,101,226)
  , "219" = c(193,226,195,234,195,248,188,250,184,254,181,258,171,262,158,265,147,265,147,232,158,232,173,230,183,228,189,227,193,226)
  , "220" = c(243,265,239,249,238,238,237,229,233,218,227,223,214,222,209,221,206,220,207,233,207,239,209,244,223,272,229,268,237,266,243,265)
  , "221" = c(50,266,47,275,44,280,48,287,53,291,58,292,60,289,69,273,64,268,60,266,50,266)
  , "222" = c(98,249,96,260,96,260,94,279,92,287,91,317,103,310,110,303,115,293,117,282,117,269,113,260,107,252,102,249,98,249)
  , "223" = c(146,266,146,305,144,320,136,325,130,326,121,326,113,325,104,322,93,317,101,312,108,306,114,297,116,288,117,270,114,262,113,258,121,262,129,264,139,265,146,266)
  , "224" = c(150,320,160,326,174,327,186,323,198,319,201,317,189,310,182,301,178,292,177,287,176,272,178,265,181,258,170,263,160,265,146,266,147,291,147,309,150,320)
  , "225" = c(202,316,202,295,199,272,197,260,195,249,191,250,186,253,181,259,178,267,176,274,177,286,180,296,184,303,190,310,202,316)
  , "226" = c(233,289,238,290,243,287,248,281,249,279,248,278,245,272,243,267,240,266,232,267,227,269,224,273,233,289)
  , "227" = c(44,280,37,282,30,288,26,293,21,297,17,299,17,302,23,302,32,295,32,309,30,322,28,335,31,335,37,314,35,328,33,337,36,336,39,339,49,318,49,325,45,335,47,337,53,325,55,313,57,312,60,302,60,290,57,291,52,291,47,286,44,280)
  , "228" = c(91,317,93,335,98,357,104,384,107,394,107,400,114,396,125,397,134,398,138,401,141,403,142,386,142,355,143,336,144,321,140,324,133,327,118,327,113,324,101,321,91,317)
  , "229" = c(150,321,150,339,150,357,151,378,152,403,159,398,168,396,178,396,184,398,186,399,186,393,195,358,200,339,201,329,201,318,194,321,182,324,175,326,161,327,153,323,150,321)
  , "230" = c(232,289,238,291,242,288,249,280,254,281,261,286,268,294,271,297,276,301,273,303,269,301,261,296,260,300,261,313,264,335,262,335,259,325,256,314,256,322,257,326,259,333,260,338,258,338,257,336,254,338,247,327,244,318,245,326,247,332,247,335,243,330,240,320,238,312,235,311,232,300,232,289)
  , "231" = c(108,400,108,412,106,421,104,431,110,436,114,437,128,437,135,435,136,428,138,419,140,411,140,404,134,399,126,397,114,396,108,400)
  , "232" = c(153,403,153,412,155,422,158,429,158,434,165,437,178,437,184,435,189,431,188,423,186,413,185,400,180,397,167,397,161,398,156,401,153,403)
  , "233" = c(104,433,102,447,102,461,104,470,113,505,119,502,121,501,132,501,135,502,137,476,137,456,135,436,130,437,116,437,109,435,104,433)
  , "234" = c(158,435,156,456,155,476,157,493,158,502,164,501,169,501,174,502,181,505,191,464,192,443,191,436,189,432,184,435,180,438,171,437,163,436,158,435)
  , "235" = c(113,506,118,526,132,526,136,524,135,504,131,502,121,502,113,506)
  , "236" = c(158,503,158,520,157,524,162,526,174,526,180,506,174,502,169,501,164,500,158,503)
  , "237" = c(109,559,110,556,115,551,119,543,117,539,119,533,118,527,127,527,132,527,135,526,138,532,138,538,137,543,136,553,137,557,139,563,137,564,130,564,126,562,116,563,113,561,109,559)
  , "238" = c(157,525,155,532,155,537,157,543,157,554,155,558,155,563,161,564,165,562,177,563,178,562,180,561,184,561,184,558,178,551,175,544,176,541,176,538,174,533,175,526,162,526,157,525)
)

male_back_poly_coords_l <- list()
for(i in 1:length(back_polys)){
  this_id <- names(back_polys)[i]
  tmp_df <- split_coords(back_polys[[i]], this_id)
  male_back_poly_coords_l[[i]] <- tmp_df
}
male_back_poly_coords_df <- do.call(rbind, male_back_poly_coords_l)
